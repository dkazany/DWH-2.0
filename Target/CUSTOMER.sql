MERGE DWH.dbo.CUSTOMER AS TARGET
USING STG.dbo.CB_CUSTOMER AS SOURCE
ON TARGET.CORE_BANKING_ID = SOURCE.SRC_SYS_ID
WHEN MATCHED THEN UPDATE 
SET FULL_NAME_EN = SOURCE.FULL_NAME_EN
WHEN NOT MATCHED BY TARGET THEN
INSERT 
(CORE_BANKING_ID,
FULL_NAME_EN,
FULL_NAME_AZ,
FIRST_NAME_EN,
FIRST_NAME_AZ,
MID_NAME_EN,
MID_NAME_AZ,
LAST_NAME_EN,
LAST_NAME_AZ,
NATIONALITY_CD,
GENDER,
RESIDENCE_CD,
RESIDENT_YN,
SECTOR_ID,
INDUSTRY_ID,
CUSTOMER_STATUS_ID,
CUST_TYPE_CD,
INDUSTRY_SUBTYPE_ID,
BUSINESS_TYPE_ID,
BIRTH_DATE,
OPENING_DATE)
VALUES
(SRC_SYS_ID,
FULL_NAME_EN,
FULL_NAME_AZ,
FIRST_NAME_EN,
FIRST_NAME_AZ,
MID_NAME_EN,
MID_NAME_AZ,
LAST_NAME_EN,
LAST_NAME_AZ,
NATIONALITY_CD,
GENDER,
RESIDENCE_CD,
RESIDENT_YN,
SECTOR_ID,
INDUSTRY_ID,
CUSTOMER_STATUS_ID,
CUST_TYPE_CD,
INDUSTRY_SUBTYPE_ID,
BUSINESS_TYPE_ID,
BIRTH_DATE,
OPENING_DATE);