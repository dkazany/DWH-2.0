INSERT INTO STG.dbo.CB_CUSTOMER
(SRC_SYS_ID,
FULL_NAME_EN,
FULL_NAME_AZ,
FIRST_NAME_EN,
FIRST_NAME_AZ,
MID_NAME_EN,
MID_NAME_AZ,
LAST_NAME_EN,
LAST_NAME_AZ,
NATIONALITY_CD,
GENDER,
RESIDENCE_CD,
RESIDENT_YN,
SECTOR_ID,
INDUSTRY_ID,
CUSTOMER_STATUS_ID,
CUST_TYPE_CD,
INDUSTRY_SUBTYPE_ID,
BUSINESS_TYPE_ID,
BIRTH_DATE,
OPENING_DATE
)
SELECT 
CUSTOMER_CODE,
CASE WHEN CUST_TYPE = 'I' THEN SHORT_NAME + ISNULL(' '+NAME_1,'') + ISNULL (' '+NAME_2,'') ELSE SHORT_NAME END AS FULL_NAME_EN,
CASE WHEN CUST_TYPE = 'I' THEN CUS_LAST_NAME_AZ + ISNULL(' '+CUS_FIRST_NAME_AZ,'') + ISNULL (' '+CUS_MID_NAME_AZ,'') ELSE CUS_LAST_NAME_AZ END AS FULL_NAME_AZ,
NAME_1 AS FIRST_NAME_EN,
CUS_FIRST_NAME_AZ AS FIRST_NAME_AZ,
NAME_2 AS MID_NAME_EN,
CUS_MID_NAME_AZ AS MID_NAME_AZ,
CASE WHEN CUST_TYPE = 'I' THEN SHORT_NAME END AS LAST_NAME_EN,
CASE WHEN CUST_TYPE = 'I' THEN CUS_LAST_NAME_AZ END AS LAST_NAME_AZ,
NATIONALITY,
GENDER,
RESIDENCE,
RESIDENT_YN,
SECTOR AS SECTOR_ID,
INDUSTRY AS INDUSTRY_ID,
CUSTOMER_STATUS,
CUST_TYPE,
SUBTYPE_OF_INDUSTRY,
BUSINESS_TYPE,
BIRTH_INCORP_DATE,
OPENING_DATE
FROM SRC_T24.dbo.FBNK_CUSTOMER;